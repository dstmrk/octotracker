services:
  # Bot Telegram - gira 24/7
  - type: worker
    name: octotracker-bot
    runtime: python
    plan: free
    buildCommand: "pip install -r requirements.txt"
    startCommand: "python bot.py"
    envVars:
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: GITHUB_TOKEN
        sync: false
      - key: GITHUB_REPO
        value: "dstmrk/octotracker"
      - key: GITHUB_BRANCH
        value: "main"
      - key: PYTHON_VERSION
        value: 3.11.0

  # Scraper - cron giornaliero alle 9:00 (ora italiana)
  - type: cron
    name: octotracker-scraper
    runtime: python
    plan: free
    schedule: "0 8 * * *"
    buildCommand: "./build.sh"
    startCommand: "./run_scraper.sh"
    envVars:
      - key: GITHUB_TOKEN
        sync: false
      - key: GITHUB_REPO
        value: "dstmrk/octotracker"
      - key: GITHUB_BRANCH
        value: "main"
      - key: PYTHON_VERSION
        value: 3.11.0

  # Checker - cron giornaliero alle 10:00 (ora italiana)
  - type: cron
    name: octotracker-checker
    runtime: python
    plan: free
    schedule: "0 9 * * *"
    buildCommand: "pip install -r requirements.txt"
    startCommand: "./run_checker.sh"
    envVars:
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: GITHUB_TOKEN
        sync: false
      - key: GITHUB_REPO
        value: "dstmrk/octotracker"
      - key: GITHUB_BRANCH
        value: "main"
      - key: PYTHON_VERSION
        value: 3.11.0
